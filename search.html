---
layout: min
---

<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@4.78.1/dist/instantsearch.production.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/typesense-instantsearch-adapter@2.9.0/dist/typesense-instantsearch-adapter.min.js"></script>


<script type="text/javascript" language="JavaScript">

    function unescapeHtml(text) {
        const map = {
            '&amp;': '&',
            '&lt;': '<',
            '&gt;': '>',
            '&quot;': '"',
            '&#39;': "'",
        };
        return text.replace(/&(amp|lt|gt|quot|#39);/g, (entity) => map[entity]);
    }


    // Search

    addEventListener("DOMContentLoaded", (event) => {

        const typesenseInstantSearchAdapter = new TypesenseInstantSearchAdapter({
            server: {
                apiKey: '8kn384jvMx0QeP1rDfaZO1u3N21ntXOr', // Be sure to use an API key that only allows searches, in production
                nodes: [
                    {
                        host: '0fpg9nu41dat6boep.a1.typesense.net',
                        port: '443',
                        protocol: 'https',
                    },
                ],
            },
            additionalSearchParameters: {
                query_by: 'title,h1,summary,keywords,h2,h3,h4,h5,h6,text',
                sort_by: '_text_match(buckets: 10):desc',
                text_match_type: 'max_weight',
                prioritize_exact_match: false
            },
            collectionSpecificSearchParameters: {
                metalamawebA: {
                    query_by: 'title,h1,summary,keywords,h2,h3,h4,h5,h6,text',
                    sort_by: '_text_match(buckets: 10):desc',
                    text_match_type: 'max_weight',
                    prioritize_exact_match: false
                },
                metalamadocA: {
                    query_by: 'title,h1,summary,keywords,h2,h3,h4,h5,h6,text',
                    sort_by: '_text_match(buckets: 10):desc',
                    text_match_type: 'max_weight',
                    prioritize_exact_match: false
                },
            },
        });

        const searchClient = typesenseInstantSearchAdapter.searchClient;

        const search = instantsearch({
            searchClient,
            indexName: "metalamawebA",
            routing: true
        });

       

        search.addWidgets([
        

            instantsearch.widgets.searchBox({
                container: '#searchbox',
                showSubmit: false,
                showReset: false,
                placeholder: 'Search by keyword...',
                autofocus: false,
                cssClasses: {
                    input: '',
                    loadingIcon: 'stroke-primary',
                },
            }),
            instantsearch.widgets.configure({
                hitsPerPage: 20,
            }),
            instantsearch.widgets.hits({
                container: '#hits-web',
                templates: {
                    item(item) {
                        return `
                            <div>
                                <div class="hit-title">
                                    <a href="${unescapeHtml(item.link)}">${unescapeHtml(item._highlightResult.title.value)}</a>
                                </div>
                                <div class="hit-summary">
                                    ${unescapeHtml(item._highlightResult.summary.value)}
                                </div>
                            </div>
                        `;
                    },
              }
            }),
            instantsearch.widgets.pagination({
                container: '#pagination-web',
                cssClasses: {
                    list: "",
                    item: "",
                    link: "",
                    disabledItem: "disabled",
                    selectedItem: "selected"
                }
            }),
            instantsearch.widgets.index({ indexName: "metalamadocA" }).addWidgets([
                instantsearch.widgets.hits({
                    container: '#hits-doc',
                    templates: {
                        item(item) {
                            return `
                                <div>
                                    <div class="hit-title">
                                        <a href="${unescapeHtml(item.link)}">${unescapeHtml(item._highlightResult.title.value)}</a>
                                    </div>
                                    <div class="hit-summary">
                                        ${unescapeHtml(item._highlightResult.summary.value)}
                                    </div>
                                </div>
                            `;
                        },
                    }
                }),
                instantsearch.widgets.pagination({
                    container: '#pagination-doc',
                    cssClasses: {
                        list: "",
                        item: "",
                        link: "",
                        disabledItem: "disabled",
                        selectedItem: "selected"
                    }
                }),
        ])
        ]);

        
        search.start();

    });
</script>


<main role="main" class="searchPage">

    <section>
        <div class="container">
            <div class="search">
                <div class="principal">
                    <h1>Metalama Search</h1>
                    <div id="searchbox"></div>
                    <div id="stats"></div>
                    <div id="hits">
                        <div>
                            <h2>Web</h2>
                            <div id="hits-web"></div>
                            <div id="pagination-web"></div>
                        </div>
                        <div>
                            <h2>Documentation</h2>
                            <div id="hits-doc"></div>
                            <div id="pagination-doc"></div>
                    </div>
                    

                </div>
            </div>
        </div>

    </section>

</main>